(function(o,n){typeof exports=="object"&&typeof module<"u"?n(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],n):(o=typeof globalThis<"u"?globalThis:o||self,n(o.vueTyperNext={},o.Vue))})(this,function(o,n){"use strict";const w={data:{type:[String,Array],default:""},handlerNum:{type:Number,default:1,validator(i){if(i>0)return!0;throw Error("handlerNum必须大于0")}},typeSpeed:{type:Number,default:15},typeSpeedLine:{type:Number,default:100},cursorChar:{type:String,default:"_"},back:{type:Boolean,default:!1},backSpeed:{type:Number,default:30},scrollDom:{type:String,default:""}},B="",N={class:"content"},b=["innerHTML"],m=n.defineComponent({name:"vueTyperNext",__name:"typer",props:w,emits:["complete","lineComplete"],setup(i,{expose:d,emit:h}){const a=i,e=n.ref("");let u=1,p="start",y;const r=`<span class="cursorChar">${a.cursorChar}</span>`;n.watch(()=>a.data,()=>{console.log("watch"),u=a.handlerNum,T()},{immediate:!0});function v(){e.value="",e.value=e.value+r}async function T(){if(Array.isArray(a.data)){for(;u>0;)v(),await k(),u--;h("complete")}else{for(;u>0;)v(),await C(),u--;h("complete")}}async function C(){for(let t=0;t<a.data.length;t++){const l=a.data[t];e.value=e.value.slice(0,e.value.length-r.length)+l+(t<a.data.length-1?e.value.slice(e.value.length-r.length):""),await c(a.typeSpeed),g()}}async function k(){for(let t=0;t<a.data.length;t++){const l=a.data[t];if(l)for(let s=0;s<l.length;s++){const f=l[s],S=e.value.length-r.length;e.value=e.value.slice(0,S)+f+e.value.slice(S),p==="pause"&&await c(),await c(a.typeSpeed),g()}if(h("lineComplete"),await c(a.typeSpeedLine),a.back){if(l&&t<a.data.length-1)for(let s=0;s<l.length;s++){const f=e.value.length-r.length;e.value=e.value.slice(0,f-1)+e.value.slice(f),await c(a.backSpeed)}}else e.value=e.value.slice(0,e.value.length-r.length)+"<br/>"+(t<a.data.length-1?e.value.slice(e.value.length-r.length):"")}}function c(t){return new Promise(l=>{t?setTimeout(l,t):y=window.setInterval(()=>{p==="start"&&(l(),clearInterval(y))},100)})}function g(){if(a.scrollDom){const t=document.querySelector(a.scrollDom);t&&(t.scrollTop=t.scrollHeight)}}function D(){p="start"}function A(){p="pause"}return d({start:D,pause:A}),(t,l)=>(n.openBlock(),n.createElementBlock("div",N,[n.renderSlot(t.$slots,"prefix"),n.createElementVNode("div",{class:"result",innerHTML:e.value},null,8,b),n.renderSlot(t.$slots,"suffix")]))}}),x=[m],_=i=>{x.map(d=>{i.component(d.name,d)})};o.default=_,o.vueTyperNext=m,Object.defineProperties(o,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
